<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.wddyxd.productservice.mapper.UserCouponMapper">

    <resultMap id="UserCouponVOMap" type="com.wddyxd.productservice.pojo.VO.UserCouponVO">
        <id column="id" property="id"/>
        <result column="name" property="name"/>
        <result column="get_type" property="getType"/>
        <result column="target_type" property="targetType"/>
        <result column="is_discount" property="isDiscount"/>
        <result column="target_id" property="targetId"/>
        <result column="threshold" property="threshold"/>
        <result column="value" property="value"/>
        <result column="start_time" property="startTime"/>
        <result column="end_time" property="endTime"/>
        <result column="stock" property="stock"/>
        <result column="sending_stock" property="sendingStock"/>
        <result column="status" property="status"/>
        <result column="create_time" property="createTime"/>
        <result column="update_time" property="updateTime"/>
        <result column="is_deleted" property="isDeleted"/>
        <result column="pointer" property="pointer"/>
        <result column="get_time" property="getTime"/>
        <result column="use_time" property="useTime"/>
        <result column="order_id" property="orderId"/>
        <result column="use_status" property="useStatus"/>
    </resultMap>

    <select id="listUserCouponVO" resultMap="UserCouponVOMap">
        SELECT
        c.*,
        uc.get_time,
        uc.use_time,
        uc.order_id,
        uc.use_status
        FROM user_coupon uc
        INNER JOIN coupon c
        ON uc.coupon_id = c.id
        AND c.is_deleted = 0
        WHERE
        uc.user_id = #{userId}
        AND uc.is_deleted = 0
        ORDER BY
        c.end_time ASC,
        uc.get_time DESC
    </select>

</mapper>